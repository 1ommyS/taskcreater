<?phpnamespace App\Repositories\Implementations;use App\Repositories\Interfaces\ITransactionsRepository;use Illuminate\Support\Facades\Auth;use Illuminate\Support\Facades\DB;class TransactionsRepository implements ITransactionsRepository{    public function getAuxilsOnWeeks (array $weeks): array    {        $information = [];        foreach ( $weeks as $week ) {            $information[] = $this->getAuxilsDuringPeriod($week["start"], $week["end"]);        }        return $information;    }    public function getAuxilsDuringPeriod (string $start, string $end)    {        $information = DB::table("other_payments")->where([            [                "date",                ">=",                $start . " 00:00:00",            ],            [                "date",                "<=",                $end . " 23:59:00",            ],        ])->orderBy("date", "desc")->get();        return $information;    }    public function getSumTransactionsInTeacherGroupsDuringPeriod ($teacher_id, string $start, string $end)    {        return DB::select("SELECT SUM(sum_transaction) AS `sum` FROM transactions WHERE group_id IN (SELECT id FROM `groups` WHERE teacher_id = ?) AND transactions.date_transaction >= ? AND transactions.date_transaction <= ? AND transactions.student_id != 1", [            $teacher_id,            $start . " 00:00:00",            $end . " 23:59:59",        ])[0]->sum;    }    public function getWagesInTeacherGroupsDuringPeriod ($teacher_id, string $start, string $end)    {        return DB::select("SELECT SUM(lesson_cost)*0.4 AS `sum` FROM student_lessons WHERE group_id IN (SELECT id FROM `groups` WHERE teacher_id = ?) AND date >= ? AND date <= ?", [            $teacher_id,            $start . " 00:00:00",            $end . " 23:59:59",        ])[0]->sum;    }    public function getTeacherPremium ($teacher_id, string $start, string $end)    {        return DB::select("SELECT SUM(value) AS `sum` FROM premiums  WHERE  teacher_id = ? AND created_at>= ? AND created_at <= ?", [            $teacher_id,            $start . " 00:00:00",            $end . " 23:59:59",        ])[0]->sum;    }    public function getSumTransactionsDuringPeriod (string $start, string $end)    {        return DB::table("transactions")->where([            [                "date_transaction",                ">=",                $start . " 00:00:00",            ],            [                "date_transaction",                "<=",                $end . " 23:59:00",            ],            [                "student_id",                "<>",                1,            ],        ])->sum("sum_transaction");    }    public function getSumTransactionsOnPeriodInGroup ($group, string $start, string $end)    {        $revenue = DB::table("transactions")->where([            [                "group_id",                $group->id,            ],            [                "date_transaction",                ">=",                $start . " 00:00:00",            ],            [                "date_transaction",                "<=",                $end . " 23:59:00",            ],            [                "student_id",                "<>",                1,            ],        ])->sum("sum_transaction");        return $revenue;    }    public function getAllTransactions (string $start, string $end): int    {        return DB::table("transactions")->where([            [                "date_transaction",                ">=",                $start . " 00:00:00",            ],            [                "date_transaction",                "<=",                $end . " 23:59:00",            ],            [                "student_id",                "<>",                1,            ],        ])->sum("sum_transaction");    }    public function getSumAuxPaymentsOnPeriod (string $start, string $end): int    {        $other_payments = DB::table("other_payments")->where([            [                "date",                ">=",                $start . " 00:00:00",            ],            [                "date",                "<=",                $end . " 23:59:00",            ],        ])->sum("price");        return $other_payments;    }}